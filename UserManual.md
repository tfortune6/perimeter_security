# 智能周界安全监控平台 - 用户使用手册

欢迎使用智能周界安全监控平台。本手册旨在帮助初次使用的用户快速了解系统功能、核心逻辑及操作流程。

---

## 1. 系统概述

本系统利用 **YOLOv8** 深度学习模型与 **ByteTrack** 追踪技术，实现对监控视频中人员（Person）和车辆（Vehicle）的自动识别与实时追踪。通过预设的“核心区”和“预警区”，系统能自动判定入侵行为并生成告警记录。

---

## 2. 核心功能与操作流程

### 2.1 视频管理

- **功能**：上传需要分析的监控视频。
- **操作**：在“视频管理”页面上传视频（支持 MP4等常用格式（AVI暂时不支持））。
- **注意**：视频上传后，系统会自动启动“第一阶段分析”（轨迹提取），此时状态为“分析中”。只有状态变为“已完成”后，才能进行后续的区域配置。

### 2.2 配置中心 (区域设定)

- **功能**：在画面中划定敏感区域。
- **区域类型**：
  - **核心区域 (Core Zone)**：高优先级区域。目标进入后会立即触发（带防抖）。
  - **预警区域 (Warning Zone)**：次优先级区域。目标需在区内停留一定时间才触发。
- **操作**：
  1. 点击“绘制多边形”，在画面上点击顶点进行绘制。
  2. 最后一个点靠近起点时自动闭合。
  3. **关键步骤**：设置完成后，必须点击 **“保存配置”**。这会触发“第二阶段分析”，根据新防区重新计算所有历史告警。

### 2.3 控制面板 (Dashboard)

- **功能**：实时展示监控效果与告警事件。
- **展示**：
  - **绿框**：正常追踪中的目标。
  - **红框**：触发了核心区告警的目标。
  - **橙框**：触发了预警区告警的目标。
- **实时事件**：右侧列表会滚动显示当前视频时刻产生的最新告警。

---

## 3. 判定逻辑说明 (必读)

为了确保告警的准确性并减少误报，系统遵循以下判定规则：

### 3.1 判定基准点

系统判断目标是否进入区域，并非依据整个方框，而是依据目标的 **“脚点”**（即目标框底边的中点）。

### 3.2 核心区告警逻辑 (红色)

- **触发条件**：目标脚点进入核心区，并 **连续停留超过 10 帧**（约 0.3 - 0.4 秒）。
- **告警等级**：`CRITICAL` (严重)。
- **冷却时间**：同一目标触发后会有 5.0 **秒** 的冷却期，期间不会重复产生相同告警。

### 3.3 预警区告警逻辑 (黄色/橙色)

- **触发条件**：目标脚点进入预警区，且 **连续停留时间超过 3.5 秒**。
- **设计初衷**：主要用于识别“长时间逗留”行为，过滤掉正常的快速穿行。
- **告警等级**：`WARNING` (警告)。

---

## 4. 常见问题排查

- **为什么画面里有人却没有红框？**

  - 请检查脚点是否真正进入了多边形内部。
  - 确认是否点击了“保存配置”以生成分析结果。
  - 在 Dashboard 页面点击“刷新检测结果”按钮。
- **为什么告警列表有延迟？**

  - 请参考上述“连续停留”和“冷却时间”的规则说明。

## 5. 技术基本信息

- **算法架构**：YOLOv8n + ByteTrack
- **检测类别**：人 (Person)、车 (Vehicle)
- **后端架构**：FastAPI + SQLModel
- **前端架构**：Vue 3 + Vite + Element Plus
